<p id="notice"><%= notice %></p>


<%- model_class = @person.class -%>
<div class="page-header">
  <h1><%= t '.title', :default => model_class.model_name.human %></h1>
</div>



<div class="container-fluid">
  <div class="row-fluid">
    <div class="span2">
      <ul class="nav nav-list">
        <li class="active">
          <a href="#">Selected:</a>
        </li>
        <li>
          <a href="#"><%= @person.firstname %> <%= @person.surname %></a>
        </li>
        <li>
          <a href="#"><%= @person.idnumber %></a>
        </li>
        <li>
          <a href="#"><%= @person.email %></a>
        </li>
      </ul>
    </div>
    <div class="span10">
      <% if @person.activities.any? %>
          <ul class="nav nav-pills">

            <ul class="nav nav-pills">
              <li class="active">
                <a href="#"><%= @person.firstname+" "+@person.surname+"'s activities ("+@person.activities.count.to_s+")" %></a>
              </li>
            </ul>
            <table class="table table-striped table-bordered table-condensed">
              <thead>
              <tr>
                <th>Activity</th>
                <th>Tags</th>
                <th>Posted</th>
                <th></th>
              </tr>
              </thead>
              <% @person.activities.each do |activity| %>
                  <tbody>
                  <tr>
                    <td><%= activity.description %> (<%= activity.tags.count %>)</td>
                    <td>
                      <% if activity.tags.any? %>
                          <% activity.tags.each do |tags| %>
                              <span class="label label-success"><%= tags.name %></span>
                          <% end %>
                      <% else %>
                          <span class="label label-warning">Untagged</span>
                      <% end %>
                    </td>
                    <td><span class="timestamp"><%= time_ago_in_words(activity.created_at) %> ago.</span>
                    </td>
                    <td><%= link_to "Delete", activity, method: :delete,
                                    confirm: "You sure you want to delete the activity? All it's tags will also be removed!",
                                    title: activity.description %>
                    </td>
              <% end %>
              </tr>
              </tbody>
            </table>
            <%= will_paginate @activities %>
      <% end %>
      <a href="#modal-window" data-toggle='modal' data-backdrop="static" class="btn">Add</a>
      <%= link_to 'Add a new activity for this person', new_person_activity_path(@person), {:remote => true, 'data-controls-modal' => "modal-window", 'data-backdrop' => true, 'data-keyboard' => true, class: "btn btn-small btn-inverse", :id => 'add_activity'} %>
    </div>
  </div>
</div>

<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")),
              people_path, :class => 'btn' %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_person_path(@person), :class => 'btn' %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              person_path(@person),
              :method => 'delete',
              :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')),
              :class => 'btn btn-danger' %>
</div>

<div class="modal hide fade" id="modal-window">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">Ã—</button>
  </div>

  <div class="modal-body center">

    <h2>Add activity </h2>
    <%= render :partial => "shared/activity_form", :locals => {:person => @person} %>
  </div>

  <div class="modal-footer">&nbsp;
  </div>
</div>